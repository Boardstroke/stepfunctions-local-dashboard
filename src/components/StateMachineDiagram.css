/* Diagram Page Layout */
.diagram-page {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 90px);
  margin: -20px -30px;
}

/* Header */
.diagram-header {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 12px 20px;
  background: #12131a;
  border-bottom: 1px solid #2a2d3e;
}

.btn-back {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  background: #1e2030;
  border: 1px solid #3a3d4e;
  border-radius: 6px;
  color: #e2e4e9;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-back:hover {
  background: #282a3a;
  border-color: #4a4d5e;
}

.diagram-title {
  flex: 1;
}

.diagram-title h2 {
  margin: 0 0 4px 0;
  color: #ffffff;
  font-size: 18px;
  font-weight: 600;
}

.diagram-arn {
  display: inline-block;
  padding: 3px 8px;
  background: #1e2030;
  border-radius: 4px;
  color: #8b9dc3;
  font-size: 11px;
  font-family: "SF Mono", "Fira Code", "Consolas", monospace;
}

.diagram-actions {
  display: flex;
  gap: 10px;
}

.diagram-actions .btn {
  padding: 8px 16px;
  font-size: 12px;
}

/* Diagram Container */
.diagram-container {
  flex: 1;
  background: #0d0e14;
  position: relative;
}

/* ============================================
   REFINED NODE STYLES - Clean & Readable
   ============================================ */

.custom-node {
  position: relative;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
}

.custom-node-content {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 16px;
  border-radius: 8px;
  border: 2px solid;
  min-width: 120px;
  transition: all 0.15s ease;
}

.custom-node:hover .custom-node-content {
  filter: brightness(1.1);
  transform: translateY(-1px);
}

.custom-node-icon {
  font-size: 16px;
  flex-shrink: 0;
  opacity: 0.9;
}

.custom-node-label {
  font-size: 13px;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 150px;
}

.custom-node-type {
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-left: auto;
  flex-shrink: 0;
  opacity: 0.7;
  font-weight: 500;
}

/* ===== START NODE ===== */
.custom-node-start .custom-node-content {
  background: #1a2e1a;
  border-color: #4ade80;
  border-radius: 20px;
  padding: 10px 20px;
}
.custom-node-start .custom-node-label {
  color: #4ade80;
}
.custom-node-start .custom-node-icon {
  color: #4ade80;
}

/* ===== END NODE ===== */
.custom-node-end .custom-node-content {
  background: #2e1a1a;
  border-color: #f87171;
  border-radius: 20px;
  padding: 10px 20px;
}
.custom-node-end .custom-node-label {
  color: #f87171;
}
.custom-node-end .custom-node-icon {
  color: #f87171;
}

/* ===== TASK NODE ===== */
.custom-node-task .custom-node-content {
  background: #1e1e2e;
  border-color: #818cf8;
}
.custom-node-task .custom-node-label {
  color: #e2e4e9;
}
.custom-node-task .custom-node-type {
  color: #818cf8;
}
.custom-node-task .custom-node-icon {
  color: #818cf8;
}

/* ===== PASS NODE ===== */
.custom-node-pass .custom-node-content {
  background: #1a2530;
  border-color: #38bdf8;
}
.custom-node-pass .custom-node-label {
  color: #e2e4e9;
}
.custom-node-pass .custom-node-type {
  color: #38bdf8;
}
.custom-node-pass .custom-node-icon {
  color: #38bdf8;
}

/* ===== CHOICE NODE ===== */
.custom-node-choice .custom-node-content {
  background: #2a2510;
  border-color: #fbbf24;
}
.custom-node-choice .custom-node-label {
  color: #fef3c7;
}
.custom-node-choice .custom-node-type {
  color: #fbbf24;
}
.custom-node-choice .custom-node-icon {
  color: #fbbf24;
}

/* ===== WAIT NODE ===== */
.custom-node-wait .custom-node-content {
  background: #2a1a2a;
  border-color: #f472b6;
}
.custom-node-wait .custom-node-label {
  color: #fce7f3;
}
.custom-node-wait .custom-node-type {
  color: #f472b6;
}
.custom-node-wait .custom-node-icon {
  color: #f472b6;
}

/* ===== SUCCEED NODE ===== */
.custom-node-succeed .custom-node-content {
  background: #1a2e1a;
  border-color: #4ade80;
}
.custom-node-succeed .custom-node-label {
  color: #bbf7d0;
}
.custom-node-succeed .custom-node-type {
  color: #4ade80;
}
.custom-node-succeed .custom-node-icon {
  color: #4ade80;
}

/* ===== FAIL NODE ===== */
.custom-node-fail .custom-node-content {
  background: #2e1a1a;
  border-color: #f87171;
}
.custom-node-fail .custom-node-label {
  color: #fecaca;
}
.custom-node-fail .custom-node-type {
  color: #f87171;
}
.custom-node-fail .custom-node-icon {
  color: #f87171;
}

/* ===== PARALLEL NODE ===== */
.custom-node-parallel .custom-node-content {
  background: linear-gradient(135deg, #252040 0%, #1a1530 100%);
  border-color: #a78bfa;
  border-style: dashed;
  border-width: 2px;
}
.custom-node-parallel .custom-node-label {
  color: #e2e4e9;
}
.custom-node-parallel .custom-node-type {
  color: #a78bfa;
}
.custom-node-parallel .custom-node-icon {
  color: #a78bfa;
}

/* ===== BRANCH NODES (inside Parallel) ===== */
.custom-node.is-branch .custom-node-content {
  transform: scale(0.92);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* ===== MAP NODE ===== */
.custom-node-map .custom-node-content {
  background: #1a2a2a;
  border-color: #2dd4bf;
}
.custom-node-map .custom-node-label {
  color: #e2e4e9;
}
.custom-node-map .custom-node-type {
  color: #2dd4bf;
}
.custom-node-map .custom-node-icon {
  color: #2dd4bf;
}

/* ===== HANDLES ===== */
.custom-handle {
  width: 10px !important;
  height: 10px !important;
  background: #1e2030 !important;
  border: 2px solid #4a4d5e !important;
  border-radius: 50% !important;
}

.custom-node:hover .custom-handle {
  border-color: #6b7280 !important;
}

.custom-handle-error {
  border-color: #f87171 !important;
  background: #2e1a1a !important;
}

.custom-node:hover .custom-handle-error {
  border-color: #f87171 !important;
  background: #f87171 !important;
}

/* ===== REACT FLOW OVERRIDES ===== */

/* Controls */
.flow-controls {
  background: #1e2030 !important;
  border: 1px solid #3a3d4e !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

.flow-controls button {
  background: transparent !important;
  border-bottom: 1px solid #2a2d3e !important;
  color: #9ca3af !important;
  width: 32px !important;
  height: 32px !important;
}

.flow-controls button:hover {
  background: #282a3a !important;
  color: #e2e4e9 !important;
}

.flow-controls button:last-child {
  border-bottom: none !important;
}

.flow-controls button svg {
  fill: currentColor !important;
}

/* MiniMap */
.flow-minimap {
  background: #1e2030 !important;
  border: 1px solid #3a3d4e !important;
  border-radius: 8px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
}

/* ===== LEGEND ===== */
.diagram-legend {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 10px 20px;
  background: #12131a;
  border-top: 1px solid #2a2d3e;
}

.legend-title {
  color: #6b7280;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.legend-items {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #9ca3af;
  font-size: 11px;
}

.legend-color {
  width: 12px;
  height: 12px;
  border-radius: 3px;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

/* ===== EDGE LABELS ===== */
.react-flow__edge-textbg {
  fill: #12131a !important;
}

.react-flow__edge-text {
  font-size: 11px !important;
  font-weight: 500 !important;
  fill: #e2e4e9 !important;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .diagram-header {
    flex-wrap: wrap;
    padding: 10px 15px;
  }

  .diagram-title {
    order: 3;
    width: 100%;
    margin-top: 8px;
  }

  .diagram-legend {
    flex-wrap: wrap;
    padding: 8px 15px;
  }
}
